

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Priors &mdash; mlcg 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="Datasets" href="datasets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            mlcg
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data.html">Data Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="neighbor_list.html">Neighbor Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="coarse_graining.html">Coarse Graining</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Priors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mlcg.nn.prior.Harmonic"><code class="docutils literal notranslate"><span class="pre">Harmonic</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mlcg.nn.prior.HarmonicBonds"><code class="docutils literal notranslate"><span class="pre">HarmonicBonds</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mlcg.nn.prior.HarmonicAngles"><code class="docutils literal notranslate"><span class="pre">HarmonicAngles</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mlcg.nn.prior.Dihedral"><code class="docutils literal notranslate"><span class="pre">Dihedral</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mlcg.nn.prior.Repulsion"><code class="docutils literal notranslate"><span class="pre">Repulsion</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulation.html">Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev/dev.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mlcg</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Priors</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/priors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="priors">
<h1>Priors<a class="headerlink" href="#priors" title="Link to this heading"></a></h1>
<p><cite>mlcg.nn</cite> implements prior models that are important physical baselines imposing geometrical constraints on coarse-grained systems. These prior models can be supplied with a user-defined set of interaction parameters, or they can alternatively be parametrized directly from data for multiple interacting atom types.</p>
<p>These classes define several common molecular interactions. Because each prior subclasses <cite>torch.nn.Module</cite>, they can be treated as normal property predictors.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mlcg.nn.prior.Harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlcg.nn.prior.</span></span><span class="sig-name descname"><span class="pre">Harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlcg/nn/prior.html#Harmonic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlcg.nn.prior.Harmonic" title="Link to this definition"></a></dt>
<dd><p>1-D Harmonic prior interaction for feature <span class="math notranslate nohighlight">\(x\)</span> of the form:</p>
<div class="math notranslate nohighlight">
\[U_{\text{Harmonic}}(x) = k\left( x - x_0 \right)^2\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is a harmonic/spring constant describing the interaction
strength and <span class="math notranslate nohighlight">\(x_0\)</span> is the equilibrium value of the feature <span class="math notranslate nohighlight">\(x\)</span>.
A an optimizable constant energy offset is added during the prior parameter
fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>statistics</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></span>) – <p>Dictionary of interaction parameters for each type of atom pair/triple,
where the keys are tuples of interacting bead types and the
corresponding values define the interaction parameters. These
Can be hand-designed or taken from the output of
<cite>mlcg.geometry.statistics.compute_statistics</cite>, but must minimally
contain the following information for each key:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">tuple</span><span class="p">(</span><span class="o">*</span><span class="n">specific_types</span><span class="p">)</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;k&quot;</span> <span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="n">scalar</span> <span class="n">that</span> <span class="n">describes</span> <span class="n">the</span> <span class="n">strength</span> <span class="n">of</span> <span class="n">the</span>
        <span class="n">harmonic</span> <span class="n">interaction</span><span class="o">.</span>
    <span class="s2">&quot;x_0&quot;</span> <span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="n">scalar</span> <span class="n">that</span> <span class="n">describes</span> <span class="n">the</span> <span class="n">mean</span> <span class="n">feature</span>
        <span class="n">value</span><span class="o">.</span>
    <span class="o">...</span>

    <span class="p">}</span>
</pre></div>
</div>
<p>The keys can be tuples of 2 or 3 atom type integers.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mlcg.nn.prior.HarmonicBonds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlcg.nn.prior.</span></span><span class="sig-name descname"><span class="pre">HarmonicBonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlcg/nn/prior.html#HarmonicBonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlcg.nn.prior.HarmonicBonds" title="Link to this definition"></a></dt>
<dd><p>Wrapper class for quickly computing bond priors
(order 2 Harmonic priors)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mlcg.nn.prior.HarmonicAngles">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlcg.nn.prior.</span></span><span class="sig-name descname"><span class="pre">HarmonicAngles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlcg/nn/prior.html#HarmonicAngles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlcg.nn.prior.HarmonicAngles" title="Link to this definition"></a></dt>
<dd><p>Wrapper class for quickly computing angle priors
(order 3 Harmonic priors)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mlcg.nn.prior.Dihedral">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlcg.nn.prior.</span></span><span class="sig-name descname"><span class="pre">Dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_degs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlcg/nn/prior.html#Dihedral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlcg.nn.prior.Dihedral" title="Link to this definition"></a></dt>
<dd><p>Prior that constrains dihedral planar angles using
the following energy ansatz:
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="p">(</span>\<span class="n">theta</span><span class="p">)</span> <span class="o">=</span> <span class="n">v_0</span> <span class="o">+</span> \<span class="n">sum_</span><span class="p">{</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">}</span><span class="o">^</span><span class="p">{</span><span class="n">n_</span><span class="p">{</span><span class="n">deg</span><span class="p">}}</span> <span class="n">k1_n</span> \<span class="n">sin</span><span class="p">{(</span><span class="n">n</span>\<span class="n">theta</span><span class="p">)}</span> <span class="o">+</span> <span class="n">k2_n</span>\<span class="n">cos</span><span class="p">{(</span><span class="n">n</span>\<span class="n">theta</span><span class="p">)}</span>
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(n_{deg}\)</span> is the maximum number of terms to take in the sinusoidal series,
<span class="math notranslate nohighlight">\(v_0\)</span> is a constant offset, and <span class="math notranslate nohighlight">\(k1_n\)</span> and <span class="math notranslate nohighlight">\(k2_n\)</span> are coefficients
for each term number <span class="math notranslate nohighlight">\(n\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>statistics</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></span>) – <p>Dictionary of interaction parameters for each type of atom quadruple,
where the keys are tuples of interacting bead types and the
corresponding values define the interaction parameters. These
Can be hand-designed or taken from the output of
<cite>mlcg.geometry.statistics.compute_statistics</cite>, but must minimally
contain the following information for each key:
.. code-block:: python</p>
<blockquote>
<div><dl class="simple">
<dt>tuple(<a href="#id1"><span class="problematic" id="id2">*</span></a>specific_types)<span class="classifier">{</span></dt><dd><p>”k1s” : torch.Tensor that contains all k1 coefficients
“k2s” : torch.Tensor that contains all k2 coefficients
“v_0” : torch.Tensor that contains the constant offset
…
}</p>
</dd>
</dl>
</div></blockquote>
<p>The keys must be tuples of 4 atoms.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mlcg.nn.prior.Repulsion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlcg.nn.prior.</span></span><span class="sig-name descname"><span class="pre">Repulsion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlcg/nn/prior.html#Repulsion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlcg.nn.prior.Repulsion" title="Link to this definition"></a></dt>
<dd><p>1-D power law repulsion prior for feature <span class="math notranslate nohighlight">\(x\)</span> of the form:</p>
<div class="math notranslate nohighlight">
\[U_{ \textnormal{Repulsion}}(x) = (\sigma/x)^6\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the excluded volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>statistics</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></span>) – <p>Dictionary of interaction parameters for each type of atom pair,
where the keys are tuples of interacting bead types and the
corresponding values define the interaction parameters. These
Can be hand-designed or taken from the output of
<cite>mlcg.geometry.statistics.compute_statistics</cite>, but must minimally
contain the following information for each key:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">tuple</span><span class="p">(</span><span class="o">*</span><span class="n">specific_types</span><span class="p">)</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sigma&quot;</span> <span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="n">scalar</span> <span class="n">that</span> <span class="n">describes</span> <span class="n">the</span> <span class="n">excluded</span>
        <span class="n">volume</span> <span class="n">of</span> <span class="n">the</span> <span class="n">two</span> <span class="n">interacting</span> <span class="n">atoms</span><span class="o">.</span>
    <span class="o">...</span>

    <span class="p">}</span>
</pre></div>
</div>
<p>The keys can be tuples of 2 integer atom types.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="datasets.html" class="btn btn-neutral float-left" title="Datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="models.html" class="btn btn-neutral float-right" title="Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Felix Musil &amp; Nick Charron.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>